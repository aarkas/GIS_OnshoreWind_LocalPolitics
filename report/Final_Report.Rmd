---
title: 'Is the expansion of onshore wind energy influenced by political developments?'
output: pdf_document
    self_contained: true
    output_dir: 'data/output'
date: "2024-07-19"
---

## Introduction

Part of Germany's energy transition strategy to meet mandatory climate targets and reduce carbon emissions is to increase the construction of onshore wind farms, as they are carbon neutral and have a relatively low levelized cost of energy (LCOE). However, with growing support for right-wing parties and a strengthening of the conservative middle, one might wonder how this will affect the continued integration of renewables. Many people doubt the existence of anthropogenic climate change and therefore do not necessarily see the need to build renewables. In particular, there is significant opposition to the construction of onshore wind farms. Therefore, the aim of this project is to investigate whether there is an actual correlation between recent election results at the municipal level, taken as a measure of political orientation, and the existence and construction of wind farms in the respective districts.

```{r setup, include=FALSE}
knitr::opts_chunk$set(cache = TRUE)

library(here)
library(ggplot2)
library(dplyr)
library(sf)
library(sp)
library(raster)
library(terra)
library(ncdf4)
library(readxl)
library(ncdf4)
library(exactextractr)
library(nnet)
library(tidyr)
library(broom)

here("R/analysis/analysis.R") |> source()

here::i_am("report/Final_Report.Rmd")

```

## Data

### Vector Data

For this project two vector data sets are being used. The 2021 federal election results as well as the municipality shapefiles are from <https://www.zeit.de/politik/deutschland/2021-09/ergebnisse-bundestagswahl-gemeinde-karte> and the district-level of Germany is pulled from <https://gadm.org/download_country.html.The> wind point layer is created on basis of the most recent international Global Wind Power Tracker accessible under <https://globalenergymonitor.org/projects/global-wind-power-tracker/>. It has only wind farms with an minimum capacity of 10 MW.

Visualisation of the used wind farm points on the base layer of Germany (district level):

```{r vector, include=FALSE}
  
ggplot() +
  geom_sf(data = districts) +
  geom_sf(data = wind_points_sf, aes(color = Status, size = `Capacity (MW)`)) +
  scale_size_continuous(range = c(0.1, 2.5)) +
  theme_minimal() +
  labs(title = "Onshore Wind Farms Germany", x = "Longitude", y = "Latitude") +
  theme(plot.title = element_text(hjust = 0.5))

head(wind_points_sf)
  
```

### Raster Data

Two raster are included in this project. One is a mean wind speed raster at a height of 140m, which hereby is assumed as the average hub height of future wind turbines in Germany (<https://opendata.dwd.de/climate_environment/CDC/grids_germany/>). The data comes from a TU Dresden research project examining future wind parameters. Secondly a land use raster is utilized which was constructed on the basis of Sentinel-2 satellite data and categorizes Germany into six categories (<https://www.mundialis.de/en/germany-2020-land-cover-based-on-sentinel-2-data/>)

```{r raster, include=FALSE}
plot(land_use)

plot(wind_speed)
```

## Data Manipulation & Wrangling

In the processing steps the data representing the German federal election 2021 is joined with the corresponding municipalities. Each polygon shows the color of its strongest party in terms of percentage.

```{r election, include=FALSE}

ggplot() +
  geom_sf(data = municipalities) +
  geom_sf(data = election_mp, aes(fill = Strongest_party)) +
  scale_fill_manual(
    values = c(
      "Union" = "black",
      "SPD" = "red",
      "Linke" = "maroon3",
      "AfD" = "deepskyblue",
      "FDP" = "gold",
      "Grüne" = "green3",
      "No Data" = "grey"
    )
  ) +
  theme_minimal() +
  labs(title = "Election Results by Municipality (2021)",
       x = "Longitude",
       y = "Latitude",
       fill = "") +
  theme(plot.title = element_text(hjust = 0.5))

head(election_mp)

```

The main reason for using 2021 federal election data is the different timeframe for regional elections, which would have made comparisons difficult.

In the next steps, the raster data is reprojected and resampled before being converted into a logical raster. The aim here is to make an assumption about where wind farms can be built in the first place and where is sufficient wind. Therefore, the wind speed raster is conditioned on all pixels with a wind speed of at least 7m/s at a (hub) height of 140m, and the land use raster is filtered for all but the areas that fall into either the 'Low Vegetation' or 'Bare Soil' categories, as these can be considered the most suitable for siting wind turbines.

Overlaying the two conditional raster produces this result, with the TRUE-valued pixels representing "suitable" land:

```{r logical raster, include=FALSE}

plot(aggregated_layer)

```

## Analysis

The combined logical raster is now being used to subset the districts vector. Hereby it is presumed that at least 10% of the district area must be considered usable for the district to be included in further analysis.

As the original plan to look at the wind farm distribution at municipal level was discarded due to a lack of wind farm points, the election results are aggregated up to district level instead. The same reasoning applies to the use of all wind farm points. Due to the use of election results from 2021, it would have made more sense to only consider wind farms that were built in the period after that. However, the analysis would be much more difficult due to a lack of data points.

In the final step, two regression / correlation methods are applied to the final results. A basic histogram overview shows that the SPD has the highest average number of wind farms in the respective districts.

```{r hist, include=FALSE}
average_windfarms <- district_analysis %>%
  group_by(Strongest_party) %>%
  summarise(Average_WindFarms = mean(count, na.rm = TRUE))

ggplot(average_windfarms, aes(x = Strongest_party, y = Average_WindFarms, fill = Strongest_party)) +
  geom_bar(stat = "identity") +
  scale_fill_manual(values = c("Union" = "black", "SPD" = "red", "AfD" = "deepskyblue", "Grüne" = "green3")) +
  labs(title = "Average Number of Wind Farms in Districts by Strongest Party",
       x = "Strongest Party",
       y = "Average Number of Wind Farms", 
       fill="") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))


```

As the analysis is carried out with one categorical and one numerical variable, a linear regression model seems rather impractical. Thats why in a second step a multinomial Log-linear model is utilized. The results by both models suggest a weak positive correlation between the presence of wind farms and the likelihood of the SPD becoming the largest party, less so for the AfD and even less so for the Grüne. Implying a significant uncertainty about the impact of wind farms on political dominance. Given the low R-squared values (0.01524), the explanatory power of the model is limited, therefore additional variables would be better suited to explain variations. The p-value of 0.0531 suggests a hint of a positive relationship, but more data and in-depth analyis would be necessary.

```{r model, include=FALSE}

ggplot(plot_data, aes(x = count, y = Probability, color = Party)) +
  geom_line() +
  labs(title = "Probability of Each Party Being Strongest vs. Count of Wind Farms", x = "Count of Wind Farms", y = "Probability") +
  theme_minimal()

print(broom_model)
```

## Conclusion

In summary, the very comprehensive approach and methodology of this project leaves much room for further research. However, no meaningful conclusion could be drawn here because the analysis was relatively narrow compared to the data processing. The results are only minimally significant and more data and more variables would be needed to make more substantive statements. Besides, to assess the influence of the political variable, more than just the strongest party in each district would have to be taken into account. With a more detailed use of wind speeds, and possibly considering the power capacity of the wind turbines, it would also be possible to develop a more detailed metric. so there is still a lot of room for this topic.
